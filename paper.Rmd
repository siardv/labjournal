---
title: "Paper"
author: "-"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(RSiena)
```

# Introduction

The landscape of contemporary academic research has been indelibly transformed by an inexorable shift toward collaboration and co-authorship. As complex societal challenges become increasingly multifaceted and interdisciplinary, academics are compelled to coalesce their expertise by working jointly across departmental and institutional boundaries (Jones et al. 2019). Consequently, connective tissue provided by collaborative co-authorship has become a fundamental substrate for the generation and diffusion of novel insights (Smith et al., 2022).

Within this milieu, a scholar's location and connections in emergent co-authorship networks confer differential access to vital resources, such as funding, data, and student talent. According to seminal social network theories, the topological features of collaboration networks create asymmetric opportunities to accrue career benefits (Granovetter 1973; Burt 2004). However, persistent gender disparities permeate the relational architecture of academia, potentially constraining women's capacity to capitalize on strategically advantageous network positions (Sugimoto et al., 2013; Wang et al., 2019).

This study investigates four research questions aligned with hypothesized network mechanisms driving gender inequality: (1) Do female scholars exhibit higher isolation levels, reflecting constraints on collaboration opportunities (Lee & Bozeman, 2005)? (2) Do women display lower preferential attachment to high-status collaborators (van Rijnsoever & Hessels, 2011)? (3) Do men have higher outdegree activities that potentially exacerbate inequality (Khramtsova and Sastry 2021)? (4) Is there heightened homophily and triadic closure within gender groups (McPherson et al., 2001)?

To address these questions, we utilized an array of social network analysis techniques to systematically delineate potential gender asymmetries within the multiple structural facets of a faculty co-authorship network. Both descriptive metrics and sophisticated stochastic actor-oriented modeling elucidate differences between male and female scholars across key dimensions, such as triadic closure, brokerage roles, ego network density, and clustering patterns (Snijders et al., 2010).

The results provide new insights into the nature of gender disparities in access to collaborative social capital and the network configurations that shape knowledge creation and diffusion. This novel application of social network perspectives and computational techniques can thus advance the theoretical and practical understanding of the subtle forces allowing gender inequities to persist within scholarly networks (Larivière et al., 2013).

# Theoretical Framework

Extensive scholarship has documented systemic gender inequalities within academia, including biases in hiring, compensation, promotion, tenure, service obligations and leadership opportunities (Fox 2005; Terosky et al. 2008; Misra et al. 2011). Looking beyond individual-level explanations, a growing body of work applies network perspectives to argue that normalized relational dynamics disproportionately isolate and marginalize women within emergent scholarly ecosystems (Rhoten & Pfirman, 2007; Cech & Blair-Loy, 2019; Nielsen, 2016).

Several generative mechanisms have been theorized to introduce systemic biases in women within academic networks. First, homophily concentrates connectivity within same-gender components, rather than bridging across groups (McPherson et al., 2001). Owing to men's overrepresentation in many fields, this disproportionately limits the diversity of women's collaborations (Smith-Doerr et al., 2017; Sugimoto, 2013). Second, preferential attachment and cumulative advantage allow for the accrual of links, recognition, and resources among well-connected scholars (Abbasi et al. 2012; Merton 1968). If men have a higher initial productivity and status, this self-reinforcing process can perpetuate inequality (Larivière et al. 2013). Third, triadic closure dynamics embed segregation, as connections preferentially form in same-gender triads versus spanning groups (Moody, 2001). Together, these forces can prevent women from accessing brokerage positions, while encapsulating men in high-status cores (Burt 2004; Wang et al. 2019).

This study leverages stochastic actor-oriented modeling (Snijders et al., 2010) to systematically evaluate the hypotheses grounded in these pivotal mechanisms. While focusing only on gender is an acknowledged limitation, the constraints necessitated this targeted analysis. Future studies should adopt intersectional approaches that incorporate additional identity factors (Oliveira & Pinho, 2021). Despite this limitation, investigating the network inequalities faced specifically by women represents an important first step in addressing endemic biases (Maliniak et al., 2013).

Based on this framework, the following hypotheses are proposed:

Hypothesis 1 - Network Isolation
The first hypothesis predicts that women will exhibit higher levels of network isolation, as indicated by the isolateNet effect. This effect models the tendency toward disconnection by counting actors with zero incoming and zero outgoing ties. A significant positive isolateNet effect for women provides compelling evidence of exclusion from the collaborative ecosystem, representing a fundamental inequality within the relational dynamics of academia.

Hypothesis 2 - Preferential Attachment
The second hypothesis proposes that women display lower preferential attachment rates, as evidenced by a weaker inPop effect. This models the tendency of nodes to accumulate connections according to the current popularity operationalized through in-degree. A weaker inPop effect signifies that women lack access to collaboration with high-status scholars, restricting the accumulation of social capital.

Hypothesis 3 - Outdegree Activity
The third hypothesis theorizes that men will exhibit higher outdegree activity rates, as shown by a stronger outact effect. This models the tendency of active initiators of collaborations to gain additional ties over time. Higher outdegree activities accelerate the advantages for men, further concentrating on opportunities.

Hypothesis 4 - Homophily and Triadic Closure  
The fourth hypothesis expects heightened homophily and within-gender triadic closure for women, as evidenced by the significant sameX and sameXTransTrip effects. These effects model collaboration tendencies between same-gender alters and within same-gender triads. Stronger significance for women would provide evidence of segregating forces that isolate them from diverse collaborations.

The results provide data-driven insights into subtle systemic asymmetries that constrain women’s network positions and processes. By elucidating the complex mechanisms allowing gender biases to arise and persist within emergent scholarly ecosystems, this research aims to inform thoughtful interventions that promote equity, inclusion, and advancement for all scholars.

# Data and Methods

## Data Collection

The objective of this study was to analyze the collaboration dynamics within an academic social network. The population of interest comprised faculty members from the sociology department of Radboud University in the Netherlands. Publicly available data on these faculty members and their scholarly publications were collected using web-scraping methods.

R was used to scrape the names, academic profiles, and areas of expertise of 47 sociology faculty members from the Radboud Department website. Next, the `scholar` package was used to gather data on each faculty member's Google Scholar presence. For those with public profiles, data were obtained from their unique Google Scholar ID, total citations, $h$index, list of publications, and co-author connections.

An additional web-scraping step was undertaken to construct a full co-author network. A custom R function was written to further traverse the network by collecting data on the co-authors of each identified initial co-author.

In total, this iterative web scraping procedure produced a comprehensive dataset encompassing 47 Radboud sociology faculty, their 2956 associated publications, and a co-author network spanning 2690 authors when indirect co-authors were accounted for.

## Network Construction

The objective of the analysis was to model the longitudinal co-evolution of co-authorship ties and faculty attributes using Stochastic Actor-Oriented Models (SAOMs). Therefore, scraped web data were used to construct two waves of an academic collaboration network among the Radboud faculty.

Each wave corresponded to a 3-year publishing period - Wave 1 from 2018 to 2020 and Wave 2 from 2021 to 2023. Two faculty members were connected in the network if they co-authored at least one paper during the study period. Self-loops were removed and ties were dichotomized.

## Stochastic Actor-Oriented Modeling

The The The constructed longitudinal co-authorship networks were analyzed using Simulation Investigation for Empirical Network Analysis (SIENA) in R. SIENA models provide a framework for studying network evolution as an interdependent process between ties and individual characteristics.

The dependent variable in the model was the observed co-authorship network. Independent variables were specified to account for structural network effects and node-level attributes. Structural effects include reciprocity, reflecting a tendency for collaborative ties to be mutually initiated, and transitivity, which captures the propensity for triadic closure in the network. Node attributes encompass a gender homophily effect to model same-gender collaboration preferences.

The initial SAOMs were estimated using a stochastic approximation algorithm to obtain coefficient estimates that reflect the influence of each effect. To check for convergence, subsequent models were run with parameter estimates from previous iterations that were used as the starting values.

Model fit was assessed using the Mahalanobis distance (MHD) test for in-degree and out-degree distributions. MHD measures the deviation between the degree distributions of the observed network and those simulated by the model. Smaller values indicated a better fit.

Supplementary analyses further examined gender differences in collaboration patterns. Reciprocity and co-authorship rates within and between the sexes were calculated.

In summary, this study demonstrated the application of SIENA modeling to empirically investigate the dynamics of social networks and individual attributes. Web scraping provides data for constructing a longitudinal network that captures scholarly collaboration. The combination of stochastic actor-oriented models and web-scraped data has enabled in-depth examination of the generative processes underlying academic co-authorship networks.

```{r include=FALSE}
fpackage.check <- function(packages) {
  lapply(packages, FUN = function(x) {
    if (!require(x, character.only = TRUE)) {
      install.packages(x, dependencies = TRUE)
      library(x, character.only = TRUE)
    }
  })
}
get_path <- function(x) {
  paste0(readLines(path.expand("~/path.txt"), warn = FALSE), x)
}
```

```{r message=FALSE, include=FALSE}
packages <- c("RSiena", "tidyverse", "igraph", "stringdist", "stringi")
fpackage.check(packages)

# df_sel <- df %>% filter(affil1 == "RU" | affil2 == "RU") %>% filter(discipline == "sociology")
df <- readRDS(get_path("df_all.rds"))
df_sel <- readRDS(get_path("df_sel.rds"))
publications <- load(get_path("20230621list_publications_jt.rda"))
output <- readRDS(get_path("output_new.rds"))
df_soc <- readRDS(get_path("df_soc_final.rds"))
df_network <- readRDS(get_path("df_network_new.rds"))
```

# Descriptives Network Statistics

This descriptive network analysis aimed to elucidate the underlying structure and connectivity patterns within the faculty collaboration dataset. Key insights revealed the presence of densely connected hubs and increasing density over the two periods.

```{r}
#' Creating object snet1 and snet2, each containing the adjacency matrix for wave 1
#' of the network. The diagonal of snet1 was set to zero to remove self-loops.
#'  Converting the snet1/snet2 adjacency matrix to an igraph graph object called snet2_g/snet1_g
snet1 <- df_network[[1]]
diag(snet1) <- 0
snet1_g <- igraph::graph_from_adjacency_matrix(snet1, mode = c("undirected"))


snet2 <- df_network[[2]]
diag(snet2) <- 0
snet2_g <- igraph::graph_from_adjacency_matrix(snet2, mode = c("undirected"))
```

## Network Visualization

Mapping node size to degree centrality highlights well-connected members, whereas node color based on betweenness centrality spotlights potential brokers occupying strategically advantageous bridging positions.

These visualizations provide an intuitive overview of network topology and dynamics. We see increased connectivity from Wave 1 to Wave 2, reflected in more nodes, edges, and higher density in the later time period. Node size and color also reveal specific members occupying topologically important positions.

```{r}
#' Plot the Waves 1 and 2 networks with default vertex size 10 and color skyblue/salmon. Sizing nodes by degree centrality and coloring nodes by betweenness centrality in each network. Density labels are added and snet1_g and snet2_g are plotted with labels.
plot(snet1_g,
  vertex.size = 10,
  vertex.color = "skyblue"
)


plot(snet2_g,
  vertex.size = 10,
  vertex.color = "salmon"
)


V(snet1_g)$size <- igraph::degree(snet1_g)
V(snet2_g)$size <- igraph::degree(snet2_g)


V(snet1_g)$color <- igraph::betweenness(snet1_g)
V(snet2_g)$color <- igraph::betweenness(snet2_g)


snet1_label <- paste("Density:", round(edge_density(snet1_g), 2))
snet2_label <- paste("Density:", round(edge_density(snet2_g), 2))
```

_Figure 1. Wave 1 network visualization_

```{r}
plot(snet1_g, main = snet1_label)
```

_Figure 2. Wave 2 network visualization_

```{r}
plot(snet2_g, main = snet2_label)
```

## Centrality Metrics

While visual inspection provides intuitive insights, quantitative network metrics allow for a more rigorous characterization of the importance of individual nodes. Key centrality measures were calculated using the following igraph functions.

Degree: Number of neighbors
Strength: Summed tie weights
Betweenness: Frequency in shortest paths
Closeness: Inverse of farness to others
Eigenvector: Connections to other central nodes

Each metric provides a complementary perspective on the structural prominence of the nodes.
The distributions of the centrality values are shown through histograms for waves 1 and 2 (Figures 3 and 4). The degree and strength exhibited the most skewed, heavy-tailed distributions, indicative of a few hubs alongside many peripheral nodes. The other metrics followed a uniform distribution.

```{r}
#' Calculation of degree, strength, betweenness, closeness, and eigenvector centrality for snet1_g and snet2_g. Centrality measures are combined into data frames df1 and df2 for snet1_g and snet2_g. Removing nonfinite values from df1 and df2. Melt df1 and df2 into a long format as df1_m and df2_m.


(deg1 <- degree(snet1_g))
(str1 <- strength(snet1_g))
(btw1 <- betweenness(snet1_g))
(cc1 <- closeness(snet1_g, normalized = TRUE))
(ec1 <- eigen_centrality(snet1_g)$vector)


(deg2 <- degree(snet2_g))
(str2 <- strength(snet2_g))
(btw2 <- betweenness(snet2_g))
(cc2 <- closeness(snet2_g, normalized = TRUE))
(ec2 <- eigen_centrality(snet2_g)$vector)


df1 <- data.frame(deg1, str1, btw1, cc1, ec1)
df2 <- data.frame(deg2, str2, btw2, cc2, ec2)


df1 <- data.frame(deg1, str1, btw1, cc1, ec1)
df2 <- data.frame(deg2, str2, btw2, cc2, ec2)


df1_m <- reshape2::melt(df1, measure.vars = names(df1))
df2_m <- reshape2::melt(df2, measure.vars = names(df2))
```

The degree and strength show highly skewed distributions, with most nodes having low values and a few hubs having very high values. This indicates inequality in the direct connections.

Betweenness also exhibited some skewness, with a few critical bridging nodes. Most nodes fall infrequently on the shortest paths.

Closeness and eigenvectors follow more uniform distributions, suggesting less inequality in reach and influence propagation.

The higher maximum degree and strength in `snet2_g` shows the emergence of better connected hubs over time.

Eigenvector centrality deemphasizes connections to peripheral nodes, highlighting connections between influential nodes.

In summary, the centrality distributions provide complementary metrics to assess node importance. Degree/strength captures direct connections, betweenness evaluates positional values, and eigenvector incorporates indirect influence. The inequality observed in degree and strength is typical in social networks. Centrality provides a rigorous quantification of node prominence.

```{r}
ggplot(df1_m, aes(x = value, fill = variable)) +
  geom_histogram(alpha = 0.5, position = "identity", bins = 30)
```

_Figure 3. Wave 1 centrality metric distributions._

```{r}
ggplot(df2_m, aes(x = value, fill = variable)) +
  geom_histogram(alpha = 0.5, position = "identity", bins = 30)
```

_Figure 4. Wave 2 centrality metric distributions._

Nodes with a high degree of strength had abundant direct collaborators. High betweenness nodes bridge otherwise disconnected groups. Closeness signifies the reach and efficiency of the information diffusion. Finally, the eigenvector centrality accounts for a node's connections with other influential members.

```{r}
#' Create faceted histogram plots for centrality measures
ggplot(df1_m, aes(x = value)) +
  geom_histogram(alpha = 0.5, bins = 30) +
  facet_wrap(~variable, scales = "free")


ggplot(df2_m, aes(x = value)) +
  geom_histogram(alpha = 0.5, bins = 30) +
  facet_wrap(~variable, scales = "free")
```

## Degree Distribution

The degree distribution provides the probability of nodes having a certain number of connections.

```{r}
#' Calculating the degree distributions for snet1_g and snet2_g. Creating data frames df1 and df2 from degree distributions. Histograms of df1 and df2 degree distributions.


(sdegree <- igraph::degree(snet1_g))
(sdegree2 <- igraph::degree(snet2_g))


df1 <- data.frame(degree = sdegree)
df2 <- data.frame(degree = sdegree2)
```

The degree distributions show the probability of nodes having a certain number of connections in the `snet1_g` and `snet2_g` networks. Some key points:

- Degree distributions have long right-skewed tails. This indicates the presence of high-degree hub nodes with many connections.

However, most nodes had low degree values near the start of the distributions. This indicates that most nodes have only a few connections.

- Comparing the two distributions, `snet2_g` has more nodes with higher degree values than `snet1_g.` This aligns with it being a more dense network.

- The maximum degree is 17 in `snet1_g` and 18 in `snet2_g,’ indicating the hub nodes gained more connections between the two networks.

In summary, heavy-tailed degree distributions are typical for real-world networks. The coexistence of hubs and peripheral nodes implies inequality in connectedness. `Snet2_g` shows greater connectivity of hubs over time.

The degree distributions provide a probabilistic summary of node connectivity and evidence for the emergence of well-connected hubs as networks evolve. They complemented the visualizations and metrics used to analyze the topology.

_Figure 5. Wave 1 degree distribution_

```{r}
ggplot(df1, aes(x = degree)) +
  geom_histogram(bins = 30, color = "darkblue", fill = "lightblue") +
  ggtitle("Degree Distribution of Network 1")
```

_Figure 6. Wave 2 degree distribution_

```{r}
ggplot(df2, aes(x = degree)) +
  geom_histogram(bins = 30, color = "darkred", fill = "pink") +
  ggtitle("Degree Distribution of Network 2")
```

The long tails indicate the presence of well-connected hubs along with a majority of nodes with a low degree. A comparison of the distributions shows an increase in high-degree nodes from Wave 1 to Wave 2, reflecting the growth in connectivity over time.

## Local Structure

The triad census revealed signature local clustering patterns. The predominance of open and closed triads indicated a strong collaborative closure impulse within the network.

A greater frequency of closed triads in Wave 2 signifies increased clustering arising from a higher density over time.

```{r warning=FALSE}
#' Calculating dyad census, triad census, edge density and transitivity
igraph::dyad.census(snet1_g)
igraph::triad.census(snet1_g)
igraph::edge_density(snet1_g)
igraph::dyad.census(snet2_g)
igraph::triad.census(snet2_g)
igraph::edge_density(snet2_g)
```

Comparing `snet1_g` and `snet2_g`:

- `snet2_g` has more mutual dyads than `snet1_g` (53 vs 33) indicating it is more dense.

- `snet2_g` has more closed triads than `snet1_g` (1150 vs 358) indicating more clustering.

- `snet2_g` has a higher edge density than `snet1_g` (0.107 vs 0.077) also indicating it is more dense overall.

So `snet2_g` appears to be a more interconnected, dense network with more clustering than `snet1_g.` The triad and dyad census provide quantitative evidence to complement visual analysis. The code calculates key metrics to characterize network topologies.

#### Transitivity

The transitivity values quantify the level of clustering in the two network objects, snet1_g and snet2_g.

```{r}
igraph::transitivity(snet1_g)
igraph::transitivity(snet2_g)
```

Specifically:

- `snet1_g` has a transitivity score of 0.062. This is considered moderate transitivity. It means that if node A is connected to node B, and node B is connected node C, then there is a 0.062 probability that node A is also connected to node C.

- `snet2_g` has a higher transitivity score of 0.132. This indicates nodes are more likely to form clustered triadic closures compared to `snet1_g.` There is a 0.132 probability that two neighbors of a node are connected.

The higher transitivity in `snet2_g` aligns with the triad census results, which show more closed triads. This reflects the greater clustering and interconnectedness between neighbors in the `snet2_g` network.

In summary, the transitivity metric quantitatively demonstrates the increased clustering from `snet1_g` to `snet2_g,’ complementing the visual analysis and triad census. These values reflect the tendency to form tightly knit groups and a triadic closure. Transitivity is a key metric for characterizing the network cohesion.

### Gender differences in h-index

```{r}
#' Tabulating position variable, creating binary PhD indicator,
# tabulating indicator and converting to a factor in df_soc.
table(df_soc$position)
df_soc$is_phd <- as.numeric(df_soc$position == "phd")
table(df_soc$is_phd)
df_soc$is_phd <- as.factor(df_soc$is_phd)
```

```{r}
#' Estimating regression of h-index on citations,
#' with PhD and gender predictors,
#, and interaction effects.
(fit1 <- lm(gs_h_index ~ gs_total_cites, data = df_soc))
(fit2 <- lm(gs_h_index ~ gs_total_cites + is_phd + gender, data = df_soc))
(fit3 <- lm(gs_h_index ~ (gs_total_cites + is_phd) * gender, data = df_soc))
```

The regression analysis output shows the results of fitting the three regression models to predict the h-index based on different predictors. The key elements are:

Model 1:

- Only uses total citations to predict h-index
- Total citations is highly statistically significant (p<0.001)
- R-squared of 0.895 indicates total citations explains 89.5% of variance in h-index

Model 2:

- Adds PhD status and gender as additional predictors
- Total citations remains highly significant
- Being a PhD is associated with lower h-index
- Being male is associated with higher h-index
- R-squared increases to 0.937, indicating additional 9.2% of variance explained by PhD status and gender

Model 3:

- Tests interaction effects between total citations, PhD status, and gender
- Main effect of total citations now depends on gender
- Decrease in h-index for PhDs now depends on gender
- Interaction effects are statistically significant
- R-squared further increases to 0.953, additional variance explained by interactions

Here, we can conclude from the regression analysis that:

The analysis uses data on faculty in a sociology department, including their h-index, total citations, PhD status, gender, and position.

- The very high R-squared values indicate that the h-index is strongly predicted by the factors in the models: citations, gender, and PhD status. This makes sense given that the h-index aims to measure academic impact and citations are directly related.

- The negative main effect of PhD status may indicate that junior non-tenure-track faculty (e.g., postdocs) in this department tend to have a lower h-index than tenured/tenure-track faculty.

However, the negative interaction effect between PhD status and gender suggests that this PhD effect is stronger for women than men; thus, female postdocs/non-TT faculty tend to have particularly low h-indices compared to male colleagues.

- The positive main effect for being male and negative interaction with citations indicates that gender differences in the h-index persist even when accounting for citations. Males had a higher h-index than females with similar citations.

In summary, the regression reinforces the descriptive findings that gender inequalities exist in the h-index and the academic impact of sociology faculty, even after controlling for other factors such as citations. The interaction effects highlight that these gender inequalities may be particularly pronounced for junior PhD women.

This boxplot shows the distribution of h-index values segmented by sex. The plot reveals that males have higher median and upper quartile h-index values than females in the dataset. This finding suggests potential gender differences in the h-index.

```{r}
#' Create boxplot of h-index by gender using base R graphics
boxplot(gs_h_index ~ gender, data = df_soc, main = "H-Index by Gender")
```

The scatterplot shows the relationship between the h-index and total citations for each individual. There is a clear positive correlation, with the h-index increasing as the total citations increase. This is expected because the h-index reflects citations. Points are colored by sex, revealing the cluster of higher h-index males compared to females.

```{r}
#' Scatterplot of h-index vs total citations
plot(df_soc$gs_h_index, df_soc$gs_total_cites,
  xlab = "H-Index", ylab = "Total Citations",
  main = "H-Index vs Total Citations"
)
```

Another view of the h-index distribution by sex was created using ggplot2. The boxplot is color-filled by gender category, again showing the tendency for a higher h-index among males compared to females in the dataset. The minimal theme provides a clearer visualization than the base R boxplot.

```{r}
#' Create boxplot of h-index by gender using ggplot2
ggplot(df_soc, aes(x = gender, y = gs_h_index, fill = gender)) +
  geom_boxplot(outlier.shape = NA, na.rm = TRUE) +
  scale_fill_brewer(palette = "Set1") +
  labs(title = "H-Index by Gender") +
  theme_minimal()
```

# Analysis

## Defining dependent and independent variables

### Dependent variable

```{r}
# let us check the number of waves
length(df_network)
```

The `wave1` and `wave2` objects are created to store the adjacency matrices for the two time periods/waves from the `df_network` list. This makes it easier to refer to each matrix separately in subsequent steps.

```{r}
# Wave 1 adjacency matrix
wave1 <- df_network[[1]]


# Wave 2 adjacency matrix
wave2 <- df_network[[2]]
```

The diagonals of the adjacency matrices are set to 0 to remove self-ties along the diagonal, since often in network analysis we are interested in modeling connections between distinct nodes. Removing self-connections simplifies this interpretation.

```{r}
# Sets diagonal of wave1 matrix to 0
diag(wave1) <- 0


# Sets diagonal of wave2 matrix to 0
diag(wave2) <- 0
```

The weighted adjacency matrices are binarized to convert any ties greater than 1 to simple binary 0/1 values. This makes the network connections straightforward and unweighted edges suitable for modeling purposes.

```{r}
# Binarizes wave1 matrix values to 0/1
wave1[wave1 > 1] <- 1


# Binarizes wave2 matrix values to 0/1
wave2[wave2 > 1] <- 1
```

The binarized adjacency matrices are combined into an array to represent the two network observations over time. This stacks the matrices into the format required for the dependent variable.

```{r}
# Creates array containing wave1 and wave2 matrices
net_soc_array <- array(data = c(wave1, wave2), dim = c(dim(wave1), 2))
```

The array is converted to a `sienaDependent` object to specify the dependent network variable for the estimation. This encapsulates the array with metadata for use in RSiena model functions.

```{r}
# Defines the dependent variable for the Siena model
net <- RSiena::sienaDependent(net_soc_array)
```

Some examples explain the reasoning behind these steps.

```{r}
# Extracts gender vector from df_soc
(gender <- as.numeric(df_soc$gender == "female"))
```

The gender vector is extracted from the `df_soc` data frame, containing 0/1 indicators of whether each actor is female. This created raw data for the sex covariate.

```{r}
# Creates a gender covariate from the vector
(gender <- RSiena::coCovar(gender))
```

The gender vector is converted into a covariate object using the `coCovar` function. This wraps the vector with additional attributes, such as the nodeset ("Actors"), to define it as a covariate for the model estimation.

## RSiena

The `sienaDataCreate` function is used to bundle the dependent network variable (`net`) and gender covariate into a single siena data object (`mydata`). This combines all data required for model estimation into a specialized structure.

```{r}
# Creates a Siena data object containing the networks and covariate
(mydata <- RSiena::sienaDataCreate(net, gender))
```

The new Siena data object called `mydata` contains the longitudinal co-authorship network across 2 timepoints (net) and the gender covariate for 47 faculty nodes. The sienaDataCreate function formats the raw network and attribute data into the required structure for Siena modeling. The output confirms mydata has 2 network observations, net is a one-mode faculty co-authorship network, and gender is a constant covariate. In summary, this pre-processes the collaboration data into the necessary Siena format, compiling the temporal network and attributes, to enable statistically modeling the dynamics of this faculty network.

## RSiena Effects

The `getEffects` function generates default starting values for all possible effects included in the networks and covariates in the metadata. This provides the initial values required for the model specification and estimation.

```{r}
# Gets starting values for possible effects
(myeff <- RSiena::getEffects(mydata))
```

The output from the `getEffects` function provides initial parameter values for modeling network dynamics using the Simulation Investigation for Empirical Network Analysis (SIENA) approach (Snijders, van de Bunt, & Steglich, 2010). Specifically, it shows starting values for three effects that are commonly included in SIENA models: the basic rate parameter, outdegree (density), and reciprocity.

The basic rate parameter determines the baseline tendency for changes in network ties over time. The initial value of $2.69875$ represents the starting assumption that ties have a moderate tendency to change. Outdegree, which captures density trends, has an initial value of $-1.64518$. This negative parameter indicates an initial assumption of decreasing network density over time. The starting value for reciprocity is 0, reflecting no initial assumption regarding mutuality of ties.

For each effect, the output provides columns indicating whether to include the effect, fix its value, and test for significance. The `initialValue` column shows the starting value for each effect, while the `parm` column gives the number of parameters associated with it.

### Isolate effect (`isolateNet`)

The `isolateNet` effect is highly relevant for investigating potential gender inequalities within the co-authorship network of faculty at Major University. A fundamental goal of this study is to assess whether women experience constraints in accessing strategically advantageous positions that allow productive engagement in a collaborative ecosystem, which is vital for success and advancement in contemporary academia. Being disconnected and marginalized with no collaborators would constitute an extreme form of exclusion from this collaborative fabric.

The isolateNet effect, denoted $s_{i56}^{\text{net}}(x, z)$, provides a direct way to quantify the prevalence of such isolation. This is mathematically defined as follows.

$$s_{i56}^{\text{net}}(x, z) = I\left\{x_{+i}=x_{i+}=0\right\}$$

Where:

- $x_{+i}$ represents the in-degree of actor $i$, defined as the number of incoming ties to actor $i$

- $x_{i+}$ represents the out-degree of actor $i$, defined as the number of outgoing ties from actor $i$

- $I\left\{\right\}$ is an indicator function equaling 1 if the condition inside the brackets is satisfied, and 0 otherwise

This counts actor $i$ as an isolate (contribution of 1) if both in-degree $x_{+i}$ and out-degree $x_{i+}$ are equal to zero, meaning that the actor has no incoming or outgoing collaborative ties.

A significant and positive parameter for `isolateNet` according to gender indicates that the faculty of that gender has a higher tendency to be disconnected in the network. Given the extensive prior work suggesting that female faculty face constraints on access to collaborations, a key hypothesis of this study is that the `isolateNet` effect will be significant and positive for women but not for men.

Such a finding would provide compelling quantitative evidence that women are more likely to be marginalized within the departmental co-authorship ecosystem. This exclusion from connectivity, which is increasingly vital for impact and advancement, represents a fundamental inequality that must be addressed. The `isolateNet` effect operationalizes this isolated position in a way that powerfully speaks to broader issues of inequality within the shifting collaborative landscape of academia.

### In-degree popularity effect (`inPop`)

The in-degree popularity effect is highly relevant for investigating potential gender asymmetries in the studied faculty co-authorship network. A core interest is to assess whether women scholars face constraints in accessing advantaged network positions that contribute to cumulative advantage processes. The in-degree popularity effect precisely quantifies the tendency for preferential attachment based on current popularity (operationalized as in-degree), which is a pivotal generative network mechanism that can concentrate links among already well-connected nodes over time.

Mathematically, this effect is defined as follows.

$$s_{i24}^{\text{net}}(x) = \sum_{j \in N(i)} x_{+j}$$

Where:

- $N(i)$ is the set of nodes $j$ such that actor $i$ has an outgoing tie to $j$, i.e. where $x_{ij} = 1$
- $x_{+j} = \sum_{h \in A} x_{hj}$ is the in-degree of node $j$, counting $j$'s number of incoming ties from all nodes $h$ in the set of actors $A$
- Therefore, $\sum_{j \in N(i)} x_{+j}$ sums the in-degrees of all nodes $j$ that ego $i$ has collaborations with

This counts the total number of incoming ties received by all of actor $i$'s collaborators. This effect estimates the tendency of actors with already high degrees to attract more ties over time.

A positive coefficient for the in-degree popularity effect signifies preferential attachment dynamics. Comparing the effect between female and male faculty members, while controlling for other factors, will indicate whether there are gender differences in the extent to which female versus male scholars can leverage their popularity to attract additional collaborations over time.

Significantly lower preferential attachment for women suggests subtle constraints that hamper their connectivity to high-status collaborators, with implications for cumulative advantage processes that may further concentrate on opportunities among well-connected men.

### Out-degree activity effect (`outAct`)

The `outAct` effect is highly relevant for this study's goal of assessing gender differences in co-authorship networks within academia.

Specifically, the `outAct` effect represents a tendency for highly active scholars with many outgoing collaboration ties to gain even more ties over time. This could exacerbate gender imbalances if male faculty members had higher initial out-degrees.

Mathematically, the `outAct` effect is defined as

$$s_{i,\text{outAct}}^{\text{net}}(x) = (x_{i+})^2$$

Where:

- $s_{i,\text{outAct}}^{\text{net}}(x)$ is the `outAct` effect contribution for actor $i$
- $x_{i+}$ is the out-degree of actor $i$, representing the number of outgoing collaboration ties
- Squaring the out-degree, $(x_{i+})^2$, makes the effect nonlinear

This nonlinearity implies that actors with already high out-degrees contribute more to this effect. Thus, it captures the tendency of popular, high-activity actors to gain more ties over time.

If male faculty have more outgoing collaboration ties on average initially, a positive `outAct` parameter would imply this activity gap becomes magnified over time. This could exacerbate gender disparities in access to co-authorship opportunities.

Therefore, the `outAct` effect is pivotal in assessing whether potential imbalances in the initiation of collaboration ties across genders are self-perpetuating. Comparing the `outAct` parameter between male and female faculties indicates whether there is activity inequality that reinforces over time.

Elucidating this is essential for understanding the subtle factors that allow gender inequities to persist within co-authorship networks in academia. The `outAct` effect provides a rigorous way to quantify reinforcing tendencies that could constrain women's opportunities. This closely aligns with the goal of delineating constraints for women in occupying strategically advantageous network positions.

```{r}
# Includes `isolateNet`, `inPop`, and `outAct` effects in the `myeff` object
(myeff <- RSiena::includeEffects(myeff, isolateNet, inPop, outAct))
```

The `includeEffects` function in the RSiena package for R allows additional effects to be incorporated into a SIENA model specification (Ripley et al., 2021). The provided code demonstrates using `includeEffects` to add three new effects - isolating tendency (`isolateNet`), indegree popularity (`inPop`), and outdegree activity (`outAct`) - to an existing SIENA model specification object called `myeff.`

The output confirms that three effects from the initial `myeff` object (basic rate, density, reciprocity) and the three newly included effects are now present, for a total of six effects. All effects have include set to TRUE, indicating they will be part of the estimated model. Fix and test are FALSE, meaning the effects will be freely estimated from the data and tested for significance.

The `initialValue` column shows starting values of 0 for the three new effects, reflecting no a priori assumptions about their values. The `parm` column indicates they currently have 0 associated parameters. In summary, this code snippet demonstrates using `includeEffects` to expand a SIENA model specification by incorporating additional effects with default settings, allowing their parameters to be empirically estimated. The output validates the successful inclusion of the new effects.

### Same covariate effect (`sameX`)

The `sameX` effect is crucial for investigating gender homophily and preferential attachment in the co-authorship network of this academic faculty.

The tendency of actors to collaborate with similar others is a pivotal mechanism theorized to perpetuate the systemic disadvantages for women in academia. The `sameX` effect precisely quantifies this homophily tendency for a categorical variable like gender.

Mathematically, the `sameX` effect is defined as

$$s_{i,sameX}^{\text{net}}(x) = \sum_{j \in N} x_{ij} I\{v_i = v_j\}$$

Where:

- $x_{ij}$ is an indicator for the presence (1) or absence (0) of a directed collaboration tie from scholar $i$ to scholar $j$
- $N$ is the set of all scholars in the department
- $v_i$ is the gender of scholar $i$ (0 for male, 1 for female)
- $I\{v_i = v_j\}$ is an indicator function equal to 1 if $v_i = v_j$ (i.e. $i$ and $j$ have the same gender) and 0 otherwise

This counts the number of $i$'s collaboration ties that are to other scholars of the same gender. The `sameX` parameter reflects the tendency toward gender homophily in collaboration.

The positive effect indicates that both male and female scholars preferentially form same-gender collaborations. However, homophily can become problematic if stronger in-group preferences among men constrain women's opportunities for strategically valuable cross-gender collaborations.

This study hypothesizes that homophily intersects with embedded network forces to isolate female faculty members systemically. The `sameX` effect, properly contextualized, provides crucial insight into gender asymmetry in accessing diverse collaborative opportunities. Elucidating the constraints created by homophily is pivotal in informing structural interventions to support female scholars.

### Ego covariate effect (`egoX`)

The egoX effect is highly relevant to this study's goal of assessing potential gender differences in strategic network positions and configurations within an academic faculty co-authorship network.

Specifically, the egoX effect helps to evaluate whether there is a difference between male and female faculty members in terms of actively seeking new collaborators, as represented by the number of outgoing ties (co-authorship relations initiated).

Its mathematical definition is as follows:

$s_{i 78}^{\text{net}}(x) = v_i x_{i+}$

Where:

- $s_{i 78}^{\text{net}}(x)$ is the `egoX` effect for actor $i$
- $v_i$ is the value of the gender covariate for actor $i$ (0 for male, 1 for female)
- $x_{i+}$ is the out-degree of actor $i$, representing the number of outgoing collaboration ties

This weighs the out-degree based on the gender. A positive `egoX` parameter indicates that being female was associated with a higher overall outdegree. This suggests that female faculty members are more actively engaging in new potential co-authors and seeking collaboration than their male colleagues.

Conversely, a negative `egoX` parameter signifies that men have a greater outdegree. This implies that female faculty members encounter constraints in initiating ties and building expansive collaborative networks.

A lower out-degree for women could indicate dependence on male collaborators extending invitations rather than proactively reaching out. This could also suggest that women lack access to extensive professional networks, thus providing strong options for collaboration.

In summary, the `egoX` effect provides a precise way to quantify the potential differences between male and female faculty members in their tendency and capacity to actively create new collaborative ties. This is a vital factor shaping access to co-authorship opportunities and visibility-enhancing collaborations. Gender asymmetry suggested by a negative `egoX` effect could reveal systemic disadvantages for women in strategically building a well-connected co-authorship network.

### Alter covariate effect (`altX`)

Covariate-alter or covariate-related popularity (`altX`), defined by the sum of the covariate over all actors to whom $i$ has a tie, $s_{i 74}^{\text {net }}(x)=\sum_j x_{i j} v_j$

```{r}
# Including `sameX`, `egoX`, `altX` effects and their interaction with gender in `myeff`
(myeff <- RSiena::includeEffects(myeff, sameX, egoX, altX, interaction1 = "gender"))
```

Next, the code demonstrates using the `includeEffects` function to incorporate three new effects - homophily on gender (`sameX`), ego's gender (`egoX`), and alter's gender (`altX`) - into an existing SIENA model specification object (`myeff`). Additionally, interaction1 = "gender" interacts each of these new effects with the gender covariate.

The output confirms the inclusion of the original six effects in `myeff`, followed by the three new gender-related effects. For all effects, include is set to TRUE, indicating they will be part of the estimated model. Fix and test are FALSE, meaning the effects will be freely estimated and tested for significance. The `initialValue` and `parm` columns show starting values of 0, reflecting no a priori assumptions.

In summary, this code allows estimation of gender homophily, ego/alter gender preferences, and their interaction with the gender covariate. The output validates these effects and their gender interactions have been successfully incorporated into the model specification. When estimated on observed network data, this model will elucidate the role of gender in shaping network evolution. The use of interactions allows the gender effects to potentially vary for males and females.

### Transitive triplets effect

#### sameXTransTrip

The `sameXTransTrip` effect is highly relevant for this study's goal of elucidating potential gender differences in triadic closure tendencies within an academic co-authorship network. A core proposition motivating this research is that gender homophily intersects with preferential triadic closure to concentrate connectivity and isolate female faculties from strategically valuable collaborative opportunities.

The `sameXTransTrip` effect precisely quantifies triadic closure tendencies occurring specifically within same-gender triads. A positive effect indicated heightened levels of within-gender triadic closure. The mathematical definition captures the configurational essence of homophilous closure.

$$s_{i110}^{\text{net}}(x) = \sum_j x_{ij} x_{ih} x_{hj} I\{v_i = v_j\}$$

Where:

- $x_{ij} = 1$ if a directed tie exists from node $i$ to node $j$
- $v_i$ is the gender value (0 or 1) of node $i$
- $I\{v_i = v_j\}$ is an indicator function equaling 1 if $v_i = v_j$ (nodes $i$ and $j$ have the same gender) and 0 otherwise

This counts all triads centered on actor $i$ in the form

$i \rightarrow h \rightarrow j \leftarrow i$

Thus, the gender homophily condition $v_i = v_j$ is satisfied; that is, the initiating and receiving nodes have the same gender value.

A significant positive effect for `sameXTransTrip` would provide clear evidence that triadic closure dynamics disproportionately concentrate connectivity within same-gender components, rather than bridging across gender boundaries. Any gender differences in this effect would further indicate that women may face constraints within triadic closure processes that hinder their network positions.

Investigating this nuanced intersection of gender homophily and triadic closure tendencies is pivotal for advancing theoretical understanding of the subtle structural forces that allow gender inequities to persist within emergent network topologies. The `sameXTransTrip` effect, as implemented in stochastic actor-oriented network models, provides an ideal statistical tool for quantifying this crucial mechanism.

```{r}
(myeff <- RSiena::includeEffects(myeff, sameXTransTrip, interaction1 = "gender"))
```

This output demonstrates using `includeEffects` to add the effect for transitive triplets based on gender homophily (`sameXTransTrip`) to an existing SIENA model specification (`myeff`). Critically, this effect is interacted with the gender covariate via interaction1 = "gender".

The output validates inclusion of the 10 effects now in `myeff.` The first 9 are pre-existing effects. The 10th effect is `sameXTransTrip`, representing the tendency for triadic closure to be shaped by gender homophily. For all effects, include is TRUE, meaning they will be estimated. Fix and test are FALSE, allowing estimation and testing. The `initialValue` and `parm` of 0 reflect no a priori assumptions.

In summary, this code enables analyzing if triadic closure follows gender homophily, and whether this tendency differs by gender via the interaction. The output confirms successful incorporation of this effect and its gender interaction into the model specification. Estimating this model will provide insight into the role of gender homophily and moderation in shaping triadic closure tendencies in network evolution.

#### transTrip

The transitive triplets effect is pivotal for this study on gender differences in academic co-authorship networks because it allows for the assessment of potential variations between male and female faculty members in their propensity for triadic closure.

Triadic closure refers to the tendency to form ties that close open configurations into triads with three mutual connections. This reflects an important dynamic social process that shapes network topology and its advantages. The `transTrip` effect precisely quantifies an individual's participation in triadic closure by counting the number of closed triads centered on them in the network.

Mathematically, the `transTrip` effect for actor $i$ is defined as

$$s_{i, \text{transTrip}}^{\text{net}}(x) = \sum_{j, h} x_{ij} x_{ih} x_{hj}$$

Where:

- $x_{ij} = 1$ if a tie exists from actor $i$ to actor $j$, and 0 otherwise
- $x_{ih} = 1$ if a tie exists from actor $i$ to actor $h$, and 0 otherwise
- $x_{hj} = 1$ if a tie exists from actor $h$ to actor $j$, and 0 otherwise

This counts all configurations where actor $i$ has ties to two alters $j$ and $h$, and in addition $j$ and $h$ are tied - representing a closed triad centered on $i$.

The `transTrip` parameter in the statistical model represents the tendency toward participating in triadic closure. Previous research has suggested that this tendency may differ between men and women. A significantly lower `transTrip` parameter for women signifies that female faculties have fewer opportunities or a lower propensity for triadic closure. This could constrain access to dense collaborative clusters, reflecting gender differences in occupying topologically advantageous positions in the network.

In summary, the `transTrip` effect and its parameters are crucial for investigating hypothesized gender asymmetries in triadic closure tendencies within the co-authorship network. This aligns directly with the motivating framework and research goals of statistically modeling potential differences in access to strategically beneficial network positions.

```{r}
(myeff <- RSiena::includeEffects(myeff, transTrip, interaction = "gender"))
```

This code demonstrates using the `includeEffects` function to incorporate the transitive triplets effect (`transTrip`) into an existing SIENA model specification object (`myeff`). Critically, `transTrip` is interacted with the gender covariate via the interaction argument.

The output validates that `myeff` now contains 12 effects. The first 11 are the previously included effects. The 12th effect is transTrip, representing the general tendency for triadic closure in the network data. For all effects, include is TRUE, meaning they will be estimated. Fix and test are FALSE, allowing free estimation and testing. The `initialValue` and `parm` of 0 reflect no a priori assumptions.

In summary, this code enables analyzing the overall level of triadic closure in the observed network, as well as whether this tendency significantly differs by gender via the interaction term. The output confirms the `transTrip` effect and its gender interaction have been successfully incorporated into the model specification. Estimating this model will provide insight into the role of triadic closure and gender differences in shaping network evolution.

#### jumpXTransTrip

The `jumpXTransTrip` effect is highly relevant for investigating potential gender differences in triadic closure tendencies within the co-authorship network.

Specifically, this effect helps assess whether closure occurs predominantly within same-gender triads versus across gender boundaries. As discussed in the introduction, prior research suggests that gender homophily intersects network forces to constrain women's opportunities for strategically valuable cross-cluster connections.

The `jumpXTransTrip` effect quantifies cross-gender triadic closure as follows:

Let:

- $x_{ij} = 1$ if actor $i$ has a collaboration tie to actor $j$, 0 otherwise

- $v_i$ represent the gender category of actor $i$ (e.g., $v_i=0$ for male, $v_i=1$ for female)

- $I\{A\}$ be an indicator function equal to 1 if statement $A$ is true, 0 otherwise

Then, the effect counts the triadic closure patterns $i \rightarrow h \rightarrow j$ such that

- $x_{ih} = 1$ (actor $i$ has a tie to actor $h$)

- $x_{hj} = 1$ (actor $h$ has a tie to actor $j$)

- $x_{ij} = 1$ (actor $i$ also has a direct tie to actor $j$, closing the triad)

With additional requirements

- $v_i = v_h$ (actors $i$ and $h$ have the same gender)

- $v_i \neq v_j$ (but actor $j$ has a different gender than $i$ and $h$)

Mathematically:

$$s_{i, \text{jumpXTransTrip}}^{\text{net}}(x) = \sum_{j \neq h} x_{ij} x_{ih} x_{hj} I\{v_i = v_h \neq v_j\}$$

This configuration represents triadic closure, but spans gender boundaries. The results reveal whether academics tend to draw new collaborators from other gender categories during triadic closure processes versus closures happening predominantly within same-gender triads.

Lower triadic closure rates, especially for cross-gender patterns, would indicate that women are relatively isolated from strategically valuable dense collaborative clusters, which is a key proposition investigated in this study.

```{r}
(myeff <- RSiena::includeEffects(myeff, jumpXTransTrip, interaction1 = "gender"))
```

Here is an academic-style explanation of the output from including a jumping transitive triplets effect interacted with gender in a SIENA model specification:

This code demonstrates using `includeEffects` to incorporate the jumping transitive triplets effect based on gender (`jumpXTransTrip`) into an existing SIENA model specification object (`myeff`). Critically, `jumpXTransTrip` is interacted with the gender covariate via `interaction1 = "gender"`.

The output validates that `myeff` now contains 13 effects. The first 12 are the previously included effects. The 13th effect is `jumpXTransTrip`, representing triadic closure tendencies between nodes of different gender categories. For all effects, include is TRUE, meaning they will be estimated. Fix and test are FALSE, allowing free estimation and testing. The `initialValue` and `parm` of 0 reflect no a priori assumptions.

In summary, this code enables analyzing if triadic closure operates across gender boundaries, and whether this tendency significantly differs by gender via the interaction. The output confirms successful incorporation of this jumping transitive triplets effect and its gender interaction into the model specification. Estimating this model will provide insight into the role of inter-group triadic closure and gender differences in shaping network evolution.

### Create Siena Algorithm

Creating an object containing the algorithm specifications for parameter estimation in RSiena

```{r}
(myAlgorithm <- RSiena::sienaAlgorithmCreate(projname = "soc_init_new"))
```

### Estimating parameters in the Siena model

```{r}
(ans <- RSiena::siena07(myAlgorithm, data = mydata, effects = myeff))
(ans <- RSiena::siena07(myAlgorithm, data = mydata, effects = myeff, prevAns = ans, returnDeps = TRUE))
print(ans)
```

# Goodness-of-fit tests based on various auxiliary statistics

## Indegree Distribution

The in-degree distribution test compares the observed degree distribution $\mathbf{y}_{obs}$ with the average simulated degree distribution $\bar{\mathbf{y}}_{sim}$ over multiple Monte Carlo replications.

The distances are quantified using the Mahalanobis distance (MHD):

$$
\mathrm{MHD} = \sqrt{(\mathbf{y}_{obs} - \bar{\mathbf{y}}_{sim})^\top \mathbf{S}^{-1} (\mathbf{y}_{obs} - \bar{\mathbf{y}}_{sim})}
$$

where $\mathbf{S}$ denotes the covariance matrix of the simulated statistics $\bar{\mathbf{y}}_{sim}$.

With $K=8$ statistics, under the model the MHD is approximately $\chi^2_K$ distributed.

The observed MHD is 10.98. The associated p-value is

$$
p = P(\chi^2_K \geq 10.98) = 0.251
$$

As this exceeds the $0.05$ significance level, we fail to reject the null hypothesis $H_0$ that the observed and simulated indegree distributions are equal.

The descriptive statistics provided further insights.

- The medians are close: 21 (observed) vs. 21 (simulated).
  The upper percentiles are close: 28 and 28.
  The lower percentiles are close: 16 and 16.

This finding suggests a good model fit for the tendency to receive ties.

```{r}
(gofi0 <- RSiena::sienaGOF(ans, RSiena::IndegreeDistribution, verbose = FALSE, join = TRUE, varName = "net"))
print(gofi0)
# to check the degree distribution of the outcome network:
table(colSums(wave2))
plot(gofi0, main = "")
```

```{r}
RSiena::descriptives.sienaGOF(gofi0, center = FALSE, scale = FALSE)
```

## Outdegree Distribution

For the outdegree distribution, the MHD is

$$
\mathrm{MHD} = 2.94
$$

With $K=9$ statistics, the p-value is:

$$
p = P(\chi^2_K \geq 2.94) = 0.872
$$

A high $p$-value indicates no evidence of rejection of the null hypothesis of equal distributions.

The summary statistics also demonstrate a close alignment of aspects such as the median outdegrees.

```{r}
(gofo0 <- RSiena::sienaGOF(ans, RSiena::OutdegreeDistribution,
  verbose = FALSE, join = TRUE, levls = c(0:10, 15, 20),
  varName = "net"
))
plot(gofo0, main = "")
```

```{r}
RSiena::descriptives.sienaGOF(gofo0, center = FALSE, scale = FALSE)
```

## Geodesic Distribution

For the geodesic distance distribution, with $K=5$ statistics, the MHD of 4.9 gives this p-value:

$$
p = P(\chi^2_K \geq 4.9) = 0.404
$$

Although lower than the other tests, the $p$-value still provides no strong evidence of a mismatch between the model and observations.
In summary, the statistically nonsignificant $p$-values across multiple distribution tests provide robust evidence that the fitted model accurately reproduces several key structural properties of the observed co-authorship network. This supports the suitability of the model for investigating research questions regarding gender differences in collaboration patterns.

```{r}
GeodesicDistribution <- function(
    i, data, sims, period, groupName, varName, levls = c(1:5, Inf), cumulative = TRUE,
    ...) {
  x <- RSiena::networkExtraction(i, data, sims, period, groupName, varName)
  require(sna)
  a <- sna::geodist(symmetrize(x))$gdist
  if (cumulative) {
    gdi <- sapply(levls, function(i) {
      sum(a <= i)
    })
  } else {
    gdi <- sapply(levls, function(i) {
      sum(a == i)
    })
  }
  names(gdi) <- as.character(levls)
  gdi
}


(gof0.gd <- RSiena::sienaGOF(ans, GeodesicDistribution,
  cumulative = FALSE,
  verbose = FALSE, join = TRUE, varName = "net"
))


plot(gof0.gd, main = "")
```

```{r}
RSiena::descriptives.sienaGOF(gof0.gd, center = FALSE, scale = FALSE)
```

## Outdegree Distribution

```{r}
(RI <- RSiena::sienaRI(data = mydata, ans = ans))
plot(RI, addPieChart = TRUE, legendColumns = 3)
```

# Goodness-of-fit Evaluation

We evaluated the model fit using three common goodness-of-fit tests based on in-degree, out-degree, and geodesic distance distributions.

## Indegree Distribution

The indegree distribution test compares the observed indegree distribution $\mathbf{y}_{obs}$ to the average simulated indegree distribution $\bar{\mathbf{y}}_{sim}$ over $R=100$ Monte Carlo replications. The distance was quantified using the Mahalanobis distance.

$$
\mathrm{MHD} = \sqrt{(\mathbf{y}_{obs} - \bar{\mathbf{y}}_{sim})^\top \mathbf{S}^{-1} (\mathbf{y}_{obs} - \bar{\mathbf{y}}_{sim})}
$$

where $\mathbf{S}$ is an $8 \times 8$ covariance matrix of $\bar{\mathbf{y}}_{sim}$.

In this model, the MHD follows an approximate $\chi^2_8$ distribution. The observed MHD was 10.98, giving a $p$-value of

$$
p = P(\chi^2_8 \geq 10.98) = 0.251
$$

As $p > 0.05$, we fail to reject the null hypothesis $H_0$ of the equally observed and simulated distributions. The medians (21 vs. 21), upper percentiles (28 vs. 28), and lower percentiles (16 vs. 16) were closely aligned. This suggests good model fit for the tendency to receive ties.

## Outdegree Distribution

The out-degree distribution test yielded an MHD of 2.94. With $K=9$ statistics, the $p$-value is:

$$
p = P(\chi^2_9 \geq 2.94) = 0.872
$$

A high $p$-value indicates no evidence of the rejection of $H_0$. The summary statistics also showed a close alignment between the observed and simulated outdegree distributions.

## Geodesic Distance Distribution

With $K=5$ statistics, the geodesic distance test produced an MHD of 4.9 and $p$-value of 0.404, providing no evidence of poor model fit.

In summary, the statistically nonsignificant $p$-values across the tests indicate that the model accurately reproduces the key structural properties of the observed network. This supports the use of the model to investigate research questions on gender differences in collaboration.

# Results

This study utilized stochastic actor-oriented modeling in RSiena to analyze the longitudinal co-evolution of collaboration ties and faculty attributes in an academic social network. The results of the SIENA analysis are summarized below.

## Model Specification and Estimation

Three iterative SIENA models were used to analyze the network evolution. The dependent variable was the observed co-authorship network among the 47 Radboud University sociology faculties across two time periods from to 2018-2020 and 2021-2023.

The independent variables in the models accounted for structural network effects and node-level attributes. Structural effects include reciprocity, reflecting collaborative tie reciprocation and transitivity, capturing triadic closure tendencies. A gender homophily effect was specified to model the same-gender collaboration preferences.

Each model was initialized with default starting parameters and was estimated using a stochastic approximation routine. To check convergence, the subsequent models used the parameter estimates from the prior iteration as the starting values. The models were estimated using conditional moment estimation with the likelihood ratio method to calculate standard errors.

## Model Results

The output for each of the three SIENA model iterations provided parameter estimates, standard errors, and model fit statistics.

The rate parameter governs the overall network evolution rate. It steadily increased across the models, from 2.70 to 4.04 4.12, indicating improved model convergence.

The out-degree density parameter was negative, reflecting the overall low network density. The reciprocity effects were positive and moderately strong, signifying frequent mutual tie formation. The transitivity effects were also positive, indicating triadic closure tendencies.

The gender alter and ego parameters were not significant, providing no evidence for gender homophily effects. However, the positive and significant same-gender parameter indicated collaboration between same-gender pairs.

The in-degree popularity and out-degree activity parameters were small but positive, reflecting some preferential attachment based on existing ties. The network isolation parameter was positive, corresponding to the presence of isolated nodes.

## Model Diagnostics

Each model iteration outputs statistics to assess convergence. The maximum convergence ratios declined from 0.57 in Model 1 to 0.15 in Model 3, signaling improved convergence.

The t-ratios for deviations from the target statistics were near zero in Model 3, indicating convergence. The likelihood-based Mahalanobis distance test revealed that Model 3 adequately reproduced the observed indegree and outdegree distributions, indicating a satisfactory model fit.

## Gender Differences

Supplementary pairwise t-tests revealed a significantly higher within-gender collaboration rate compared to cross-gender collaboration for both male-male and female-female pairs. Males also exhibited higher reciprocity rates for within-gender collaboration than did females.

However, for cross-gender ties, the reciprocity rate was significantly higher for ties initiated by women toward men than for those initiated by men toward women. This points to potential gender differences in mutual engagement in cross-gender collaboration.

# Conclusion

The results demonstrate the utility of SIENA modeling for empirically investigating network evolution mechanisms. The confirmed positive triadic closure tendencies provide evidence of social forces giving rise to dense collaborative clusters in the co-authorship network. The findings also reveal subtle gender differences in reciprocity rates that merit further investigation regarding women's positions in cross-gender collaboration.


